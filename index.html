<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ZOLEGON</title>

<style>
body{
    margin:0;
    background:black;
    font-family:monospace;
    color:white;
    overflow:hidden;
}

/* ===== MENU ===== */
#menu{
    position:absolute;
    width:100%;
    height:100%;
    background:linear-gradient(#020024,#090979,#000000);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
}

#title{
    font-size:60px;
    color:cyan;
    text-shadow:0 0 25px cyan;
    margin-bottom:20px;
}

#startBtn{
    padding:15px 40px;
    font-size:25px;
    background:black;
    color:cyan;
    border:2px solid cyan;
    cursor:pointer;
}

#startBtn:hover{
    background:cyan;
    color:black;
}

/* ===== GAME ===== */
#gameCanvas{
    display:none;
    background:#2d6a4f;
}

#battle{
    position:absolute;
    bottom:0;
    width:100%;
    height:220px;
    background:#111;
    border-top:4px solid white;
    display:none;
}

#text{
    padding:15px;
    height:100px;
}

#buttons{
    display:flex;
}

button.action{
    flex:1;
    height:60px;
    font-size:18px;
    background:black;
    color:white;
    border:1px solid white;
    cursor:pointer;
}
button.action:hover{
    background:white;
    color:black;
}
</style>
</head>

<body>

<!-- ===== MENU ===== -->
<div id="menu">
    <div id="title">ZOLEGON</div>
    <div style="font-size:20px;margin-bottom:30px;">Thần Thú Huyền Thoại</div>
    <button id="startBtn">START GAME</button>
</div>

<canvas id="gameCanvas" width="900" height="500"></canvas>

<!-- ===== BATTLE UI ===== -->
<div id="battle">
    <div id="text">A wild creature appeared!</div>
    <div id="buttons">
        <button class="action" onclick="attack()">Attack</button>
        <button class="action" onclick="heal()">Heal</button>
        <button class="action" onclick="run()">Run</button>
    </div>
</div>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");

let player={x:420,y:230,size:25,speed:4,hp:100,maxhp:100};
let enemy={hp:80,maxhp:80};
let battle=false;

/* START */
document.getElementById("startBtn").onclick=()=>{
    document.getElementById("menu").style.display="none";
    canvas.style.display="block";
    loop();
};

/* MOVEMENT */
let keys={};
document.addEventListener("keydown",e=>keys[e.key]=true);
document.addEventListener("keyup",e=>keys[e.key]=false);

/* MAP */
function drawMap(){
    ctx.fillStyle="#2d6a4f";
    ctx.fillRect(0,0,900,500);

    /* grass area */
    ctx.fillStyle="#1b4332";
    ctx.fillRect(100,80,700,340);
}

/* PLAYER */
function drawPlayer(){
    ctx.fillStyle="cyan";
    ctx.fillRect(player.x,player.y,player.size,player.size);
}

/* ENCOUNTER */
function checkEncounter(){
    if(player.x>100 && player.x<800 && player.y>80 && player.y<420){
        if(Math.random()<0.01){
            startBattle();
        }
    }
}

function startBattle(){
    battle=true;
    enemy.hp=80;
    document.getElementById("battle").style.display="block";
    document.getElementById("text").innerText="Zolemon hoang dã xuất hiện!";
}

/* BATTLE ACTIONS */
function attack(){
    let dmg=Math.floor(Math.random()*20)+10;
    enemy.hp-=dmg;
    document.getElementById("text").innerText="Bạn gây "+dmg+" sát thương!";

    if(enemy.hp<=0){
        document.getElementById("text").innerText="Bạn thắng!";
        setTimeout(endBattle,1500);
        return;
    }

    enemyAttack();
}

function heal(){
    let heal=Math.floor(Math.random()*15)+10;
    player.hp=Math.min(player.maxhp,player.hp+heal);
    document.getElementById("text").innerText="Bạn hồi "+heal+" HP!";
    enemyAttack();
}

function run(){
    document.getElementById("text").innerText="Bạn chạy thoát!";
    setTimeout(endBattle,1000);
}

function enemyAttack(){
    let dmg=Math.floor(Math.random()*15)+8;
    player.hp-=dmg;
    setTimeout(()=>{
        document.getElementById("text").innerText="Địch tấn công gây "+dmg+" damage!";
    },600);

    if(player.hp<=0){
        setTimeout(()=>{
            alert("Bạn đã thua!");
            location.reload();
        },1200);
    }
}

function endBattle(){
    battle=false;
    document.getElementById("battle").style.display="none";
}

/* LOOP */
function update(){
    if(!battle){
        if(keys["ArrowUp"])player.y-=player.speed;
        if(keys["ArrowDown"])player.y+=player.speed;
        if(keys["ArrowLeft"])player.x-=player.speed;
        if(keys["ArrowRight"])player.x+=player.speed;

        checkEncounter();
    }
}

function drawHP(){
    ctx.fillStyle="red";
    ctx.fillRect(20,20,200,20);
    ctx.fillStyle="lime";
    ctx.fillRect(20,20,200*(player.hp/player.maxhp),20);

    ctx.fillStyle="white";
    ctx.fillText("HP: "+player.hp,25,35);
}

function loop(){
    update();
    drawMap();
    drawPlayer();
    drawHP();
    requestAnimationFrame(loop);
}
</script>

</body>
</html>


